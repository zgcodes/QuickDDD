/* ===========================================================
 * bootstrap-modalmanager.js v2.2.4
 * ===========================================================
 * Copyright 2012 Jordan Schroter.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */!function(c){function f(a){return function(b){if(this===b.target)return a.apply(this,arguments)}}var h=function(a,b){this.init(a,b)};h.prototype={constructor:h,init:function(a,b){this.$element=c(a);this.options=c.extend({},c.fn.modalmanager.defaults,this.$element.data(),"object"==typeof b&&b);this.stack=[];this.backdropCount=0;var d,e=this;c(window).on("resize.modal",function(){d&&clearTimeout(d);d=setTimeout(function(){for(var a=0;a<e.stack.length;a++)e.stack[a].isShown&&e.stack[a].layout()},10)})},createModal:function(a,b){c(a).modal(c.extend({manager:this},b))},appendModal:function(a){this.stack.push(a);var b=this;a.$element.on("show.modalmanager",f(function(d){d=function(){a.isShown=!0;var d=c.support.transition&&a.$element.hasClass("fade");b.$element.toggleClass("modal-open",b.hasOpenModal()).on("mousewheel",function(a){return!1}).toggleClass("page-overflow",c(window).height()<b.$element.height());a.$parent=a.$element.parent();a.$container=b.createContainer(a);a.$element.appendTo(a.$container);b.backdrop(a,function(){a.$element.show();d&&a.$element[0].offsetWidth;a.layout();a.$element.addClass("in").attr("aria-hidden",!1);var g=function(){b.setFocus();a.$element.trigger("shown")};d?a.$element.one(c.support.transition.end,g):g()})};a.options.replace?b.replace(d):d()}));a.$element.on("hidden.modalmanager",f(function(d){b.backdrop(a);a.$element.parent().length?a.$backdrop?(c.support.transition&&a.$element.hasClass("fade")&&a.$element[0].offsetWidth,c.support.transition&&a.$element.hasClass("fade")?a.$backdrop.one(c.support.transition.end,function(){a.destroy()}):a.destroy()):a.destroy():b.destroyModal(a)}));a.$element.on("destroyed.modalmanager",f(function(d){b.destroyModal(a)}))},getOpenModals:function(){for(var a=[],b=0;b<this.stack.length;b++)this.stack[b].isShown&&a.push(this.stack[b]);return a},hasOpenModal:function(){return 0<this.getOpenModals().length},setFocus:function(){for(var a,b=0;b<this.stack.length;b++)this.stack[b].isShown&&(a=this.stack[b]);a&&a.focus()},destroyModal:function(a){a.$element.off(".modalmanager");a.$backdrop&&this.removeBackdrop(a);this.stack.splice(this.getIndexOfModal(a),1);var b=this.hasOpenModal();this.$element.toggleClass("modal-open",b);this.$element.off("mousewheel");b||this.$element.removeClass("page-overflow");this.removeContainer(a);this.setFocus()},getModalAt:function(a){return this.stack[a]},getIndexOfModal:function(a){for(var b=0;b<this.stack.length;b++)if(a===this.stack[b])return b},replace:function(a){for(var b,d=0;d<this.stack.length;d++)this.stack[d].isShown&&(b=this.stack[d]);b?(this.$backdropHandle=b.$backdrop,b.$backdrop=null,a&&b.$element.one("hidden",f(c.proxy(a,this))),b.hide()):a&&a()},removeBackdrop:function(a){a.$backdrop.remove();a.$backdrop=null},createBackdrop:function(a,b){var d;this.$backdropHandle?(d=this.$backdropHandle,d.off(".modalmanager"),this.$backdropHandle=null,this.isLoading&&this.removeSpinner()):d=c(b).addClass(a).appendTo(this.$element);return d},removeContainer:function(a){a.$container.remove();a.$container=null},createContainer:function(a){var b;b=c('\x3cdiv class\x3d"modal-scrollable"\x3e').css("z-index",k("modal",this.getOpenModals().length)).on("").appendTo(this.$element);if(a&&"static"!=a.options.backdrop)b.on("click.modal",f(function(b){a.$element.trigger("escape.close.bb")}));else if(a)b.on("click.modal",f(function(b){a.attention()}));return b},backdrop:function(a,b){var d=a.$element.hasClass("fade")?"fade":"",e=a.options.backdrop&&this.backdropCount<this.options.backdropLimit;if(a.isShown&&e)e=c.support.transition&&d&&!this.$backdropHandle,a.$backdrop=this.createBackdrop(d,a.options.backdropTemplate),a.$backdrop.css("z-index",k("backdrop",this.getOpenModals().length)),e&&a.$backdrop[0].offsetWidth,a.$backdrop.addClass("in"),this.backdropCount+=1,e?a.$backdrop.one(c.support.transition.end,b):b();else if(!a.isShown&&a.$backdrop){a.$backdrop.removeClass("in");this.backdropCount-=1;var g=this;c.support.transition&&a.$element.hasClass("fade")?a.$backdrop.one(c.support.transition.end,function(){g.removeBackdrop(a)}):g.removeBackdrop(a)}else b&&b()},removeSpinner:function(){this.$spinner&&this.$spinner.remove();this.$spinner=null;this.isLoading=!1},removeLoading:function(){this.$backdropHandle&&this.$backdropHandle.remove();this.$backdropHandle=null;this.removeSpinner()},loading:function(a){a=a||function(){};this.$element.toggleClass("modal-open",!this.isLoading||this.hasOpenModal()).toggleClass("page-overflow",c(window).height()<this.$element.height());if(this.isLoading)if(this.isLoading&&this.$backdropHandle){this.$backdropHandle.removeClass("in");var b=this;c.support.transition?this.$backdropHandle.one(c.support.transition.end,function(){b.removeLoading()}):b.removeLoading()}else a&&a(this.isLoading);else{this.$backdropHandle=this.createBackdrop("fade",this.options.backdropTemplate);this.$backdropHandle[0].offsetWidth;var d=this.getOpenModals();this.$backdropHandle.css("z-index",k("backdrop",d.length+1)).addClass("in");d=c(this.options.spinner).css("z-index",k("modal",d.length+1)).appendTo(this.$element).addClass("in");this.$spinner=c(this.createContainer()).append(d).on("click.modalmanager",c.proxy(this.loading,this));this.isLoading=!0;c.support.transition?this.$backdropHandle.one(c.support.transition.end,a):a()}}};var k=function(){var a,b={};return function(d,e){if("undefined"===typeof a){var g=c('\x3cdiv class\x3d"modal hide" /\x3e').appendTo("body"),f=c('\x3cdiv class\x3d"modal-backdrop hide" /\x3e').appendTo("body");b.modal=+g.css("z-index");b.backdrop=+f.css("z-index");a=b.modal-b.backdrop;g.remove();f.remove()}return b[d]+a*e}}();c.fn.modalmanager=function(a,b){return this.each(function(){var d=c(this),e=d.data("modalmanager");e||d.data("modalmanager",e=new h(this,a));"string"===typeof a&&e[a].apply(e,[].concat(b))})};c.fn.modalmanager.defaults={backdropLimit:999,resize:!1,spinner:'\x3cdiv class\x3d"loading-spinner fade" style\x3d"width: 200px; margin-left: -100px;"\x3e\x3cdiv class\x3d"progress progress-striped active"\x3e\x3cdiv class\x3d"bar" style\x3d"width: 100%;"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',backdropTemplate:'\x3cdiv class\x3d"modal-backdrop" /\x3e'};c.fn.modalmanager.Constructor=h;c(function(){c(document).off("show.bs.modal").off("hidden.bs.modal")})}(jQuery);